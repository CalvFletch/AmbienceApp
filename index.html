<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; media-src 'self' file:; img-src 'self' file:; script-src 'self'">
  <title>Ambience</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Video Background -->
  <div class="video-background">
    <video id="bgVideo" muted loop></video>
    <div id="ducking-overlay"></div>
    <div class="video-overlay"></div>
  </div>

  <!-- Drag Area (top portion only) -->
  <div class="drag-area"></div>

  <!-- Notification Banner (top of app) -->
  <div class="notification-banner hidden" id="notificationBanner">
    <div class="notification-content">
      <div class="notification-left">
        <span class="notification-text" id="notificationText"></span>
        <label class="notification-checkbox" id="notificationCheckboxLabel">
          <input type="checkbox" id="notificationDontShow">
          <span>Don't show again</span>
        </label>
      </div>
      <div class="notification-buttons">
        <button class="notification-btn" id="notificationIgnoreBtn">Ignore</button>
        <button class="notification-btn" id="notificationActionBtn">Download</button>
      </div>
    </div>
  </div>

  <!-- Main Screen Corner Decorations -->
  <div class="main-corner corner-decoration corner-tl" style="top: 12px; left: 12px;"></div>
  <div class="main-corner corner-decoration corner-tr" style="top: 12px; right: 12px;"></div>
  <div class="main-corner corner-decoration corner-bl" style="bottom: 12px; left: 12px;"></div>
  <div class="main-corner corner-decoration corner-br" style="bottom: 12px; right: 12px;"></div>

  <!-- Window Controls (top right) -->
  <div class="window-controls">
    <button class="window-btn" id="settingsBtn" title="Settings">
      <svg viewBox="0 0 24 24" fill="currentColor" style="width: 14px; height: 14px;">
        <path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
      </svg>
    </button>
    <button class="window-btn" id="minimizeBtn">─</button>
    <button class="window-btn close-btn" id="closeBtn">✕</button>
  </div>

  <!-- Music List Panel (Full Page) -->
  <div class="music-list-panel hidden" id="musicListPanel">
    <!-- Corner decorations -->
    <div class="corner-decoration corner-tl" style="top: 12px; left: 12px;"></div>
    <div class="corner-decoration corner-tr" style="top: 12px; right: 12px;"></div>
    <div class="corner-decoration corner-bl" style="bottom: 12px; left: 12px;"></div>
    <div class="corner-decoration corner-br" style="bottom: 12px; right: 12px;"></div>
    <div class="music-list-header">
      <button class="back-btn" id="musicListBackBtn">
        <svg viewBox="0 0 24 24" fill="currentColor" style="width: 14px; height: 14px;">
          <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
        </svg>
      </button>
      <span id="musicListTitle">SELECT CATEGORY</span>
    </div>
    <div class="music-list" id="musicList"></div>
  </div>

  <!-- Main UI -->
  <div class="main-ui">
    <div style="flex-grow: 1;"></div> <!-- This spacer pushes content down -->
    <!-- Category Icon (top right, separate from track info) -->
    <img class="current-category-icon hidden" id="currentCategoryIcon" src="" alt="">

    <!-- Track Info -->
    <div class="track-section clickable" id="trackSection" title="Click to see track list">
      <div class="track-label" id="trackLabel">NOW PLAYING</div>
      <div class="track-name" id="trackName">No track loaded</div>
    </div>

    <!-- Controls Row - All buttons + volume on right -->
    <div class="controls-row">
      <div class="buttons-left">
        <button class="icon-btn" id="playPauseBtn" title="Play/Pause">
          <svg id="pauseIcon" viewBox="0 0 24 24" fill="currentColor">
            <rect x="6" y="4" width="4" height="16"/>
            <rect x="14" y="4" width="4" height="16"/>
          </svg>
          <svg id="playIcon" class="hidden" viewBox="0 0 24 24" fill="currentColor">
            <polygon points="5,3 19,12 5,21"/>
          </svg>
        </button>

        <button class="icon-btn" id="jumpBtn" title="+5 Minutes">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <polygon points="2,4 10,12 2,20"/>
            <polygon points="12,4 20,12 12,20"/>
          </svg>
        </button>

        <button class="icon-btn" id="skipBtn" title="Skip">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <polygon points="4,4 14,12 4,20"/>
            <rect x="14" y="4" width="4" height="16"/>
          </svg>
        </button>

        <button class="icon-btn duck-btn" id="duckBtn" title="Auto-Duck (click to enable)">
          <!-- Duck ON -->
          <svg viewBox="0 0 385.3 259.05" fill="currentColor" id="duckIconOn" class="hidden" style="height: 60%; width: auto;">
            <polygon points="290.97 259.05 94.33 259.05 52.28 97 0 97 0 0 127.32 0 169.37 162.05 215.93 162.05 257.99 0 385.3 0 385.3 97 333.03 97 290.97 259.05"/>
          </svg>
          <!-- Duck OFF -->
          <svg viewBox="0 0 385.3 97" fill="currentColor" id="duckIconOff" style="height: 25%; width: auto;">
            <rect width="385.3" height="97"/>
          </svg>
        </button>

        <!-- Volume button with popup slider -->
        <div class="volume-popup-container">
          <button class="icon-btn volume-btn" id="volumeBtn" title="Volume">
            <svg viewBox="0 0 24 24" fill="currentColor" id="volumeIcon">
              <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
            </svg>
            <svg viewBox="0 0 24 24" fill="currentColor" id="volumeMuteIcon" class="hidden">
              <path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>
            </svg>
          </button>
          <div class="volume-popup" id="volumePopup">
            <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="70" orient="vertical">
          </div>
          <div class="hover-bridge"></div>
        </div>
      </div>
    </div>

    <!-- Progress Bar - Full Width Bottom -->
    <div class="progress-section">
      <span class="time" id="currentTime">0:00</span>
      <div class="progress-bar" id="progressBar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <span class="time" id="duration">0:00</span>
    </div>
  </div>

  <!-- Audio element -->
  <audio id="audioPlayer"></audio>


  <!-- Debug Log (toggle with Ctrl+D) -->
  <div class="debug-log hidden" id="debugLog">
    <button class="debug-copy-btn" id="debugCopyBtn">Copy Log</button>
  </div>

  <!-- Process Picker Modal -->
  <div class="process-picker-overlay hidden" id="processPickerOverlay">
    <div class="process-picker-modal">
      <div class="process-picker-header">
        <span>SELECT PROGRAM</span>
        <button class="process-picker-close" id="processPickerClose">×</button>
      </div>
      <input type="text" class="process-picker-search" id="processPickerSearch" placeholder="Search...">
      <div class="process-picker-list" id="processPickerList"></div>
    </div>
  </div>

  <script src="renderer.js"></script>
</body>
</html>
